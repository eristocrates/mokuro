!function (e) { if ("object" == typeof exports && "undefined" != typeof module) module.exports = e(); else if ("function" == typeof define && define.amd) define([], e); else { var t; (t = "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : this).panzoom = e() } }(function () { return (function () { function e(t, n, o) { function r(a, c) { if (!n[a]) { if (!t[a]) { var u = "function" == typeof require && require; if (!c && u) return u(a, !0); if (i) return i(a, !0); var f = Error("Cannot find module '" + a + "'"); throw f.code = "MODULE_NOT_FOUND", f } var s = n[a] = { exports: {} }; t[a][0].call(s.exports, function (e) { return r(t[a][1][e] || e) }, s, s.exports, e, t, n, o) } return n[a].exports } for (var i = "function" == typeof require && require, a = 0; a < o.length; a++)r(o[a]); return r } return e })()({ 1: [function (e, t, n) { "use strict"; var o = e("wheel"), r = e("amator"), i = e("ngraph.events"), a = e("./lib/kinetic.js"), c = e("./lib/createTextSelectionInterceptor.js"), u = c(), f = c(!0), s = e("./lib/transform.js"), l = e("./lib/svgController.js"), p = e("./lib/domController.js"); function m(e, t) { var n, c, m, h, g, x, _, b, w, C = (t = t || {}).controller; if (!C && (l.canAttach(e) ? C = l(e, t) : p.canAttach(e) && (C = p(e, t))), !C) throw Error("Cannot create panzoom for the current type of dom element"); var E = C.getOwner(), S = { x: 0, y: 0 }, T = !1, k = new s; C.initTransform && C.initTransform(k); var L = "function" == typeof t.filterKey ? t.filterKey : d, A = "number" == typeof t.pinchSpeed ? t.pinchSpeed : 1, B = t.bounds, z = "number" == typeof t.maxZoom ? t.maxZoom : Number.POSITIVE_INFINITY, j = "number" == typeof t.minZoom ? t.minZoom : 0, M = "number" == typeof t.boundsPadding ? t.boundsPadding : .05, F = "number" == typeof t.zoomDoubleClickSpeed ? t.zoomDoubleClickSpeed : 1.75, O = t.beforeWheel || d, D = t.beforeMouseDown || d, Z = "number" == typeof t.zoomSpeed ? t.zoomSpeed : 1, I = v(t.transformOrigin), q = t.enableTextSelection ? f : u; (function e(t) { var n = typeof t; if ("undefined" !== n && "boolean" !== n && !($(t.left) && $(t.top) && $(t.bottom) && $(t.right))) throw Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}") })(B), t.autocenter && function e() { var t, n, o = 0, r = 0, i = ec(); if (i) o = i.left, r = i.top, t = i.right - i.left, n = i.bottom - i.top; else { var a = E.getBoundingClientRect(); t = a.width, n = a.height } var c = C.getBBox(); if (0 !== c.width && 0 !== c.height) { var u = n / c.height, f = Math.min(t / c.width, u); k.x = -(c.left + c.width / 2) * f + t / 2 + o, k.y = -(c.top + c.height / 2) * f + n / 2 + r, k.scale = f } }(); var P = 0, N = !1, R = !1; x = "smoothScroll" in t && !t.smoothScroll ? { start: d, stop: d, cancel: d } : a(function e() { return { x: k.x, y: k.y } }, function e(t, n) { eB(), er(t, n) }, t.smoothScroll); var V = !1; ep(); var Y = { dispose: function e() { em() }, moveBy: el, moveTo: er, smoothMoveTo: function e(t, n) { el(t - k.x, n - k.y, !0) }, centerOn: function e(t) { var n = t.ownerSVGElement; if (!n) throw Error("ui element is required to be within the scene"); var o, r = t.getBoundingClientRect(), i = r.left + r.width / 2, a = r.top + r.height / 2, c = n.getBoundingClientRect(); el(c.width / 2 - i, c.height / 2 - a, !0) }, zoomTo: eA, zoomAbs: es, smoothZoom: ek, smoothZoomAbs: function e(t, n, o) { var i = k.scale; x.cancel(), eB(), b = r({ scale: i }, { scale: o }, { step: function (e) { es(t, n, e.scale) } }) }, showRectangle: function e(t) { var n = E.getBoundingClientRect(), o = U(n.width, n.height), r = t.right - t.left, i = t.bottom - t.top; if (!Number.isFinite(r) || !Number.isFinite(i)) throw Error("Invalid rectangle"); var a, c = Math.min(o.x / r, o.y / i); k.x = -(t.left + r / 2) * c + o.x / 2, k.y = -(t.top + i / 2) * c + o.y / 2, k.scale = c }, pause: function e() { em(), V = !0 }, resume: function e() { V && (ep(), V = !1) }, isPaused: K, getTransform: H, getMinZoom: J, setMinZoom: Q, getMaxZoom: ee, setMaxZoom: et, getTransformOrigin: en, setTransformOrigin: function e(t) { I = v(t) }, getZoomSpeed: eo, setZoomSpeed: function e(t) { if (!Number.isFinite(t)) throw Error("Zoom speed should be a number"); Z = t } }; i(Y); var W = "number" == typeof t.initialX ? t.initialX : k.x, X = "number" == typeof t.initialY ? t.initialY : k.y, G = "number" == typeof t.initialZoom ? t.initialZoom : k.scale; return (W != k.x || X != k.y || G != k.Scale) && es(W, X, G), Y; function K() { return V } function U(e, t) { if (C.getScreenCTM) { var n = C.getScreenCTM(), o = n.a, r = n.d, i = n.e, a = n.f; S.x = e * o - i, S.y = t * r - a } else S.x = e, S.y = t; return S } function H() { return k } function J() { return j } function Q(e) { j = e } function ee() { return z } function et(e) { z = e } function en() { return I } function eo() { return Z } function er(e, t) { k.x = e, k.y = t, ea(), e1("pan"), eu() } function ei(e, t) { er(k.x + e, k.y + t) } function ea() { var e = ec(); if (e) { var t, n, o, r, i = !1, a = (o = C.getBBox(), r = (t = o.left, n = o.top, { x: t * k.scale + k.x, y: n * k.scale + k.y }), { left: r.x, top: r.y, right: o.width * k.scale + r.x, bottom: o.height * k.scale + r.y }), c = e.left - a.right; return c > 0 && (k.x += c, i = !0), (c = e.right - a.left) < 0 && (k.x += c, i = !0), (c = e.top - a.bottom) > 0 && (k.y += c, i = !0), (c = e.bottom - a.top) < 0 && (k.y += c, i = !0), i } } function ec() { if (B) { if ("boolean" == typeof B) { var e = E.getBoundingClientRect(), t = e.width, n = e.height; return { left: t * M, top: n * M, right: t * (1 - M), bottom: n * (1 - M) } } return B } } function eu() { T = !0, n = window.requestAnimationFrame(ev) } function ef(e, t, n) { if (y(e) || y(t) || y(n)) throw Error("zoom requires valid numbers"); var o = k.scale * n; if (o < j) { if (k.scale === j) return; n = j / k.scale } if (o > z) { if (k.scale === z) return; n = z / k.scale } var r = U(e, t); (k.x = r.x - n * (r.x - k.x), k.y = r.y - n * (r.y - k.y), B && 1 === M && 1 === j) ? (k.scale *= n, ea()) : ea() || (k.scale *= n), e1("zoom"), eu() } function es(e, t, n) { ef(e, t, n / k.scale) } function el(e, t, n) { if (!n) return ei(e, t); _ && _.cancel(); var o = 0, i = 0; _ = r({ x: 0, y: 0 }, { x: e, y: t }, { step: function (e) { ei(e.x - o, e.y - i), o = e.x, i = e.y } }) } function ep() { E.addEventListener("mousedown", eb, { passive: !1 }), E.addEventListener("dblclick", e_, { passive: !1 }), E.addEventListener("touchstart", ed, { passive: !1 }), E.addEventListener("keydown", eh, { passive: !1 }), o.addWheelListener(E, eS, { passive: !1 }), eu() } function em() { o.removeWheelListener(E, eS), E.removeEventListener("mousedown", eb), E.removeEventListener("keydown", eh), E.removeEventListener("dblclick", e_), E.removeEventListener("touchstart", ed), n && (window.cancelAnimationFrame(n), n = 0), x.cancel(), eC(), eE(), q.release(), eM() } function ev() { T && (T = !1, C.applyTransform(k), e1("transform"), n = 1) } function eh(e) { var t = 0, n = 0; if (38 === e.keyCode ? t = 1 : 40 === e.keyCode ? t = -1 : 189 === e.keyCode || 109 === e.keyCode ? n = 1 : (187 === e.keyCode || 107 === e.keyCode) && (n = -1), !L(e, 0, t, n)) { if (t) { e.preventDefault(), e.stopPropagation(); var o = E.getBoundingClientRect(), r = Math.min(o.width, o.height); el(0, .05 * r * t) } if (n) { var i, a = ez(100 * n), r = I ? eL() : (i = E.getBoundingClientRect(), { x: i.width / 2, y: i.height / 2 }); eA(r.x, r.y, a) } } } function ed(e) { var n, o, r, i; if (n = e, (!t.onTouch || t.onTouch(n)) && (n.stopPropagation(), n.preventDefault()), 1 === e.touches.length) { return o = e, e.touches[0], r = eT(o.touches[0]), c = r, i = U(r.x, r.y), void (m = i.x, h = i.y, x.cancel(), e$()) } 2 === e.touches.length && (g = ex(e.touches[0], e.touches[1]), w = !0, e$()) } function e$() { !N && (N = !0, document.addEventListener("touchmove", ey), document.addEventListener("touchend", eg), document.addEventListener("touchcancel", eg)) } function ey(e) { if (1 === e.touches.length) { e.stopPropagation(); var t = eT(e.touches[0]), n = U(t.x, t.y), o = n.x - m, r = n.y - h; 0 !== o && 0 !== r && ej(), m = n.x, h = n.y, el(o, r) } else if (2 === e.touches.length) { w = !0; var i = e.touches[0], a = e.touches[1], c = ex(i, a), u = 1 + (c / g - 1) * A, f = eT(i), s = eT(a); if (m = (f.x + s.x) / 2, h = (f.y + s.y) / 2, I) { var t = eL(); m = t.x, h = t.y } eA(m, h, u), g = c, e.stopPropagation(), e.preventDefault() } } function eg(e) { if (e.touches.length > 0) { var t = eT(e.touches[0]), n = U(t.x, t.y); m = n.x, h = n.y } else { var o = new Date; if (o - P < 300) { if (I) { var t = eL(); ek(t.x, t.y, F) } else ek(c.x, c.y, F) } P = o, eM(), eE() } } function ex(e, t) { var n = e.clientX - t.clientX, o = e.clientY - t.clientY; return Math.sqrt(n * n + o * o) } function e_(e) { n = e, (!t.onDoubleClick || t.onDoubleClick(n)) && (n.preventDefault(), n.stopPropagation()); var n, o = eT(e); I && (o = eL()), ek(o.x, o.y, F) } function eb(e) { if (!D(e)) { if (N) return e.stopPropagation(), !1; if (!((1 !== e.button || null === window.event) && 0 !== e.button)) { x.cancel(); var t = eT(e), n = U(t.x, t.y); return m = n.x, h = n.y, document.addEventListener("mousemove", ew), document.addEventListener("mouseup", e0), q.capture(e.target || e.srcElement), !1 } } } function ew(e) { if (!N) { ej(); var t = eT(e), n = U(t.x, t.y), o = n.x - m, r = n.y - h; m = n.x, h = n.y, el(o, r) } } function e0() { q.release(), eM(), eC() } function eC() { document.removeEventListener("mousemove", ew), document.removeEventListener("mouseup", e0), R = !1 } function eE() { document.removeEventListener("touchmove", ey), document.removeEventListener("touchend", eg), document.removeEventListener("touchcancel", eg), R = !1, w = !1, N = !1 } function eS(e) { if (!O(e)) { x.cancel(); var t = e.deltaY; e.deltaMode > 0 && (t *= 100); var n = ez(t); if (1 !== n) { var o = I ? eL() : eT(e); eA(o.x, o.y, n), e.preventDefault() } } } function eT(e) { var t, n, o = E.getBoundingClientRect(); return { x: t = e.clientX - o.left, y: n = e.clientY - o.top } } function ek(e, t, n) { var o = k.scale; x.cancel(), eB(), b = r({ scale: o }, { scale: n * o }, { step: function (n) { es(e, t, n.scale) }, done: e3 }) } function eL() { var e = E.getBoundingClientRect(); return { x: e.width * I.x, y: e.height * I.y } } function eA(e, t, n) { return x.cancel(), eB(), ef(e, t, n) } function eB() { b && (b.cancel(), b = null) } function ez(e) { return 1 - Math.sign(e) * Math.min(.25, Math.abs(Z * e / 128)) } function ej() { R || (e1("panstart"), R = !0, x.start()) } function eM() { R && (w || x.stop(), e1("panend")) } function e3() { e1("zoomend") } function e1(e) { Y.fire(e, Y) } } function v(e) { if (e) { if ("object" == typeof e) return $(e.x) && $(e.y) || h(e), e; h() } } function h(e) { throw console.error(e), Error('Cannot parse transform origin.\nSome good examples:\n  "center center" can be achieved with {x: 0.5, y: 0.5}\n  "top center" can be achieved with {x: 0.5, y: 0}\n  "bottom right" can be achieved with {x: 1, y: 1}') } function d() { } function $(e) { return Number.isFinite(e) } function y(e) { return Number.isNaN ? Number.isNaN(e) : e != e } t.exports = m, !function e() { if ("undefined" != typeof document) { var t, n = document.getElementsByTagName("script"); if (n) { for (var o = 0; o < n.length; ++o) { var r = n[o]; if (r.src && r.src.match(/\bpanzoom(\.min)?\.js/)) { t = r; break } } if (t) { var i = t.getAttribute("query"); if (i) { var a = t.getAttribute("name") || "pz", c = Date.now(); !function e() { var n, o = document.querySelector(i); if (!o) { if (Date.now() - c < 2e3) { setTimeout(e, 100); return } console.error("Cannot find the panzoom element", a); return } var r = function e(t) { for (var n = t.attributes, o = {}, r = 0; r < n.length; ++r) { var i = u(n[r]); i && (o[i.name] = i.value) } return o }(t); console.log(r), window[a] = m(o, r) }() } } } } function u(e) { if (e.name && "p" === e.name[0] && "z" === e.name[1] && "-" === e.name[2]) { var t; return { name: e.name.substr(3), value: JSON.parse(e.value) } } } }() }, { "./lib/createTextSelectionInterceptor.js": 2, "./lib/domController.js": 3, "./lib/kinetic.js": 4, "./lib/svgController.js": 5, "./lib/transform.js": 6, amator: 7, "ngraph.events": 9, wheel: 10 },], 2: [function (e, t, n) { function o(e) { return e.stopPropagation(), !1 } function r() { } t.exports = function e(t) { if (t) return { capture: r, release: r }; var n, i, a, c = !1; return { capture: function e(t) { c = !0, i = window.document.onselectstart, a = window.document.ondragstart, window.document.onselectstart = o, (n = t).ondragstart = o }, release: function e() { c && (c = !1, window.document.onselectstart = i, n && (n.ondragstart = a)) } } } }, {},], 3: [function (e, t, n) { t.exports = function e(t, n) { if (!o(t)) throw Error("panzoom requires DOM element to be attached to the DOM tree"); var r = t.parentElement; return t.scrollTop = 0, n.disableKeyboardInteraction || r.setAttribute("tabindex", 0), { getBBox: function e() { return { left: 0, top: 0, width: t.clientWidth, height: t.clientHeight } }, getOwner: i, applyTransform: function e(n) { t.style.transformOrigin = "0 0 0", t.style.transform = "matrix(" + n.scale + ", 0, 0, " + n.scale + ", " + n.x + ", " + n.y + ")" } }; function i() { return r } }, t.exports.canAttach = o; function o(e) { return e && e.parentElement && e.style } }, {},], 4: [function (e, t, n) { t.exports = function e(t, n, o) { "object" != typeof o && (o = {}); var r, i, a, c, u, f, s, l, p, m, v = "number" == typeof o.minVelocity ? o.minVelocity : 5, h = "number" == typeof o.amplitude ? o.amplitude : .25, d = "function" == typeof o.cancelAnimationFrame ? o.cancelAnimationFrame : "function" == typeof cancelAnimationFrame ? cancelAnimationFrame : clearTimeout, $ = "function" == typeof o.requestAnimationFrame ? o.requestAnimationFrame : "function" == typeof requestAnimationFrame ? requestAnimationFrame : function (e) { return setTimeout(e, 16) }; return { start: function e() { r = t(), f = p = c = s = 0, i = new Date, d(a), d(m), a = $(y) }, stop: function e() { d(a), d(m); var n = t(); u = n.x, l = n.y, i = Date.now(), (c < -v || c > v) && (u += f = h * c), (s < -v || s > v) && (l += p = h * s), m = $(g) }, cancel: function e() { d(a), d(m) } }; function y() { var e = Date.now(), n = e - i; i = e; var o = t(), u = o.x - r.x, f = o.y - r.y; r = o; var l = 1e3 / (1 + n); c = .8 * u * l + .2 * c, s = .8 * f * l + .2 * s, a = $(y) } function g() { var e = Date.now() - i, t = !1, o = 0, r = 0; f && ((o = -f * Math.exp(-e / 342)) > .5 || o < -.5 ? t = !0 : o = f = 0), p && ((r = -p * Math.exp(-e / 342)) > .5 || r < -.5 ? t = !0 : r = p = 0), t && (n(u + o, l + r), m = $(g)) } } }, {},], 5: [function (e, t, n) { t.exports = function e(t, n) { if (!o(t)) throw Error("svg element is required for svg.panzoom to work"); var r = t.ownerSVGElement; if (!r) throw Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element"); return n.disableKeyboardInteraction || r.setAttribute("tabindex", 0), { getBBox: function e() { var n = t.getBBox(); return { left: n.x, top: n.y, width: n.width, height: n.height } }, getScreenCTM: function e() { var t = r.getCTM(); return t || r.getScreenCTM() }, getOwner: i, applyTransform: function e(n) { t.setAttribute("transform", "matrix(" + n.scale + " 0 0 " + n.scale + " " + n.x + " " + n.y + ")") }, initTransform: function e(n) { var o = t.getCTM(); null === o && (o = document.createElementNS("http://www.w3.org/2000/svg", "svg").createSVGMatrix()), n.x = o.e, n.y = o.f, n.scale = o.a, r.removeAttributeNS(null, "viewBox") } }; function i() { return r } }, t.exports.canAttach = o; function o(e) { return e && e.ownerSVGElement && e.getCTM } }, {},], 6: [function (e, t, n) { t.exports = function e() { this.x = 0, this.y = 0, this.scale = 1 } }, {},], 7: [function (e, t, n) { var o = e("bezier-easing"), r = { ease: o(.25, .1, .25, 1), easeIn: o(.42, 0, 1, 1), easeOut: o(0, 0, .58, 1), easeInOut: o(.42, 0, .58, 1), linear: o(0, 0, 1, 1) }; function i() { } function a() { var e = new Set, t = new Set, n = 0; return { next: o, cancel: o, clearAll: function o() { e.clear(), t.clear(), cancelAnimationFrame(n), n = 0 } }; function o(e) { t.add(e), n || (n = requestAnimationFrame(r)) } function r() { n = 0; var o = t; t = e, (e = o).forEach(function (e) { e() }), e.clear() } function i(e) { t.delete(e) } } t.exports = function e(t, n, o) { var a, c = Object.create(null), u = Object.create(null), f = "function" == typeof (o = o || {}).easing ? o.easing : r[o.easing]; f || (o.easing && console.warn("Unknown easing function in amator: " + o.easing), f = r.ease); var s = "function" == typeof o.step ? o.step : i, l = "function" == typeof o.done ? o.done : i, p = function e(t) { if (!t) return "undefined" != typeof window && window.requestAnimationFrame ? { next: window.requestAnimationFrame.bind(window), cancel: window.cancelAnimationFrame.bind(window) } : { next: function (e) { return setTimeout(e, 1e3 / 60) }, cancel: function (e) { return clearTimeout(e) } }; if ("function" != typeof t.next) throw Error("Scheduler is supposed to have next(cb) function"); if ("function" != typeof t.cancel) throw Error("Scheduler is supposed to have cancel(handle) function"); return t }(o.scheduler), m = Object.keys(n); m.forEach(function (e) { c[e] = t[e], u[e] = n[e] - t[e] }); var v = Math.max(1, .06 * ("number" == typeof o.duration ? o.duration : 400)), h = 0; return a = p.next(d), { cancel: function e() { p.cancel(a), a = 0 } }; function d() { var e, n = f(h / v); h += 1, e = n, m.forEach(function (n) { t[n] = u[n] * e + c[n] }), h <= v ? (a = p.next(d), s(t)) : (a = 0, setTimeout(function () { l(t) }, 0)) } }, t.exports.makeAggregateRaf = a, t.exports.sharedScheduler = a() }, { "bezier-easing": 8 },], 8: [function (e, t, n) { var o = "function" == typeof Float32Array; function r(e, t) { return 1 - 3 * t + 3 * e } function i(e, t) { return 3 * t - 6 * e } function a(e) { return 3 * e } function c(e, t, n) { var o; return ((r(t, n) * e + i(t, n)) * e + 3 * (o = t)) * e } function u(e, t, n) { var o; return 3 * r(t, n) * e * e + 2 * i(t, n) * e + 3 * (o = t) } function f(e) { return e } t.exports = function e(t, n, r, i) { if (!(0 <= t && t <= 1 && 0 <= r && r <= 1)) throw Error("bezier x values must be in [0, 1] range"); if (t === n && r === i) return f; for (var a = o ? new Float32Array(11) : Array(11), s = 0; s < 11; ++s)a[s] = c(.1 * s, t, r); return function e(o) { return 0 === o ? 0 : 1 === o ? 1 : c(function e(n) { for (var o = 0, i = 1; 10 !== i && a[i] <= n; ++i)o += .1; var f = o + (n - a[--i]) / (a[i + 1] - a[i]) * .1, s = u(f, t, r); return s >= .001 ? function e(t, n, o, r) { for (var i = 0; i < 4; ++i) { var a = u(n, o, r); if (0 === a) break; var f = c(n, o, r) - t; n -= f / a } return n }(n, f, t, r) : 0 === s ? f : function e(t, n, o, r, i) { var a, u, f = 0; do (a = c(u = n + (o - n) / 2, r, i) - t) > 0 ? o = u : n = u; while (Math.abs(a) > 1e-7 && ++f < 10); return u }(n, o, o + .1, t, r) }(o), n, i) } } }, {},], 9: [function (e, t, n) { t.exports = function e(t) { !function e(t) { if (!t) throw Error("Eventify cannot use falsy object as events subject"); for (var n = ["on", "fire", "off"], o = 0; o < n.length; ++o)if (t.hasOwnProperty(n[o])) throw Error("Subject cannot be eventified, since it already has property '" + n[o] + "'") }(t); var n, o, r = (n = t, o = Object.create(null), { on: function (e, t, r) { if ("function" != typeof t) throw Error("callback is expected to be a function"); var i = o[e]; return i || (i = o[e] = []), i.push({ callback: t, ctx: r }), n }, off: function (e, t) { if (void 0 === e) return o = Object.create(null), n; if (o[e]) { if ("function" != typeof t) delete o[e]; else for (var r = o[e], i = 0; i < r.length; ++i)r[i].callback === t && r.splice(i, 1) } return n }, fire: function (e) { var t, r = o[e]; if (!r) return n; arguments.length > 1 && (t = Array.prototype.splice.call(arguments, 1)); for (var i = 0; i < r.length; ++i) { var a = r[i]; a.callback.apply(a.ctx, t) } return n } }); return t.on = r.on, t.off = r.off, t.fire = r.fire, t } }, {},], 10: [function (e, t, n) { function o(e, t, n) { e.addEventListener("wheel", t, n) } t.exports = o, t.exports.addWheelListener = o, t.exports.removeWheelListener = function e(t, n, o) { t.removeEventListener("wheel", n, o) } }, {},] }, {}, [1])(1) });